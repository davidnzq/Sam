<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LongPort AI 助手设置</title>
    <link rel="stylesheet" href="options.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>LongPort AI 助手设置</h1>
            <p class="subtitle">配置公司内部 AI 服务，支持 Notion 和 LongPort 平台</p>
        </header>

        <main class="main-content">
            <!-- 公司内部 API 设置 -->
            <section class="section">
                <h2>公司内部 AI API 设置</h2>
                <div class="form-group">
                    <label for="companyApiUrl">API 地址</label>
                    <input type="url" id="companyApiUrl" placeholder="https://lboneapi.longbridge-inc.com/" />
                    <small>默认值: https://lboneapi.longbridge-inc.com/</small>
                </div>
                <div class="form-group">
                    <label for="companyApiKey">API 密钥</label>
                    <input type="password" id="companyApiKey" placeholder="输入您的 API 密钥" />
                    <small>默认密钥已预配置，如需修改请重新输入</small>
                </div>
                <div class="form-actions">
                    <button type="button" id="testCompanyApi" class="btn btn-secondary">测试连接</button>
                    <button type="button" id="saveCompanyApi" class="btn btn-primary">保存设置</button>
                    <button type="button" id="resetToDefault" class="btn btn-secondary">重置为默认</button>
                </div>
                <div id="companyApiStatus" class="status"></div>
            </section>

            <!-- 当前配置信息 -->
            <section class="section">
                <h2>当前配置信息</h2>
                <div class="config-info">
                    <p><strong>公司内部 AI API:</strong> <span id="currentCompanyApi">检查中...</span></p>
                    <p><strong>API 状态:</strong> <span id="apiStatus">检查中...</span></p>
                    <p><strong>优化策略:</strong> 公司内部 AI 优先，失败时使用基础优化</p>
                </div>
            </section>
            
            <!-- 快捷键设置 -->
            <section class="section">
                <h2>快捷键设置</h2>
                <p class="section-description">自定义扩展的快捷键，提高使用效率</p>
                
                <div class="shortcut-settings">
                    <div class="shortcut-item">
                        <div class="shortcut-info">
                            <h3>唤起 AI 助手弹窗</h3>
                            <p>在支持的网站上选中文本后，使用此快捷键直接唤起 AI 助手</p>
                        </div>
                        <div class="shortcut-config">
                            <div class="current-shortcut" id="show-ai-popup-shortcut">Alt+Shift+1</div>
                            <button class="btn btn-secondary btn-sm" id="edit-show-ai-popup">修改</button>
                        </div>
                    </div>
                    
                    <div class="shortcut-item">
                        <div class="shortcut-info">
                            <h3>优化选中文本</h3>
                            <p>直接对选中的文本进行 AI 优化，无需弹窗交互</p>
                        </div>
                        <div class="shortcut-config">
                            <div class="current-shortcut" id="optimize-selection-shortcut">Alt+O</div>
                            <button class="btn btn-secondary btn-sm" id="edit-optimize-selection">修改</button>
                        </div>
                    </div>
                    
                    <div class="shortcut-item">
                        <div class="shortcut-info">
                            <h3>弹窗内快速替换</h3>
                            <p>在弹窗显示优化结果后，使用此快捷键快速替换原文</p>
                        </div>
                        <div class="shortcut-config">
                            <div class="current-shortcut">Space (空格键)</div>
                            <button class="btn btn-secondary btn-sm" disabled title="此快捷键不可修改">固定</button>
                        </div>
                    </div>
                </div>
                
                <div class="shortcut-tips">
                    <h4>快捷键设置说明</h4>
                    <ul>
                        <li>快捷键必须包含修饰键（Alt、Ctrl/Command、Shift）</li>
                        <li>不能使用单个按键作为快捷键</li>
                        <li>避免使用浏览器已占用的快捷键组合</li>
                        <li>修改后需要重启浏览器才能生效</li>
                        <li>如果设置的快捷键无效，可以在 Chrome 扩展管理页面手动设置</li>
                    </ul>
                    
                    <div class="shortcut-actions">
                        <button class="btn btn-secondary" id="reset-shortcuts">恢复默认快捷键</button>
                        <a href="chrome://extensions/shortcuts" target="_blank" class="btn btn-link">打开 Chrome 快捷键设置</a>
                    </div>
                </div>
            </section>

            <!-- 支持平台信息 -->
            <section class="section">
                <h2>支持平台</h2>
                <div class="platforms">
                    <div class="platform-card">
                        <div class="platform-icon">📝</div>
                        <h3>Notion</h3>
                        <p>文档写作与协作平台</p>
                        <ul>
                            <li>智能文本优化</li>
                            <li>语法检查与修正</li>
                            <li>写作风格建议</li>
                        </ul>
                    </div>
                    <div class="platform-card">
                        <div class="platform-icon">📊</div>
                        <h3>LongPort</h3>
                        <p>金融内容创作平台</p>
                        <ul>
                            <li>长文编辑优化</li>
                            <li>短评内容增强</li>
                            <li>专业金融写作</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 使用方法 -->
            <section class="section">
                <h2>使用方法</h2>
                <div class="usage-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>选择文本</h4>
                            <p>在支持的网站页面中选择需要优化的文本内容</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>右键菜单</h4>
                            <p>右键点击选中文本，选择"校验优化内容"选项</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>AI 优化</h4>
                            <p>等待公司内部 AI 生成优化结果，查看改进建议</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>应用结果</h4>
                            <p>选择"应用优化结果"、"重试AI调用"或关闭弹窗</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>弹窗拖拽</h4>
                            <p>长按弹窗头部可以拖拽移动，避免遮挡内容</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI 服务说明 -->
            <section class="section">
                <h2>AI 服务说明</h2>
                <div class="ai-service-info">
                    <div class="service-card">
                        <div class="service-icon">🏢</div>
                        <h3>公司内部 AI</h3>
                        <p>使用公司内部训练的 AI 模型，专门针对金融和文档写作场景优化，提供最准确和专业的文本优化服务。</p>
                        <ul>
                            <li>专业金融术语优化</li>
                            <li>文档逻辑结构改进</li>
                            <li>语法和表达准确性提升</li>
                            <li>保持原文语义不变</li>
                        </ul>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">🔧</div>
                        <h3>基础优化</h3>
                        <p>当 AI 服务不可用时，系统会自动进行基础文本优化，包括标点符号标准化、空格清理等基础处理。</p>
                        <ul>
                            <li>标点符号标准化</li>
                            <li>多余空格清理</li>
                            <li>换行符优化</li>
                            <li>基础格式调整</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 文案优化设置 -->
            <section class="section">
                <h2>文案优化设置</h2>
                <p class="section-description">配置文案优化的默认行为和边界约束</p>
                
                <div class="form-group">
                    <label for="defaultScene">默认场景</label>
                    <select id="defaultScene">
                        <option value="console">产品内文案</option>
                        <option value="marketing">营销/官网</option>
                        <option value="notification">通知/弹窗</option>
                    </select>
                    <small>选择默认的文案场景，影响风格和术语约束</small>
                </div>
                
                <div class="form-group">
                    <label for="defaultMode">默认模式</label>
                    <select id="defaultMode">
                        <option value="optimize">文案优化（受边界约束）</option>
                        <option value="proofread">语法校对（最小改动）</option>
                    </select>
                    <small>选择默认的优化模式</small>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="strictBoundary" checked />
                        严格边界模式
                    </label>
                    <small>启用时，命中阻断规则将回退到最小改动</small>
                </div>
                
                <div class="form-actions">
                    <button type="button" id="saveOptimizeSettings" class="btn btn-primary">保存设置</button>
                    <button type="button" id="resetOptimizeSettings" class="btn btn-secondary">恢复默认</button>
                </div>
                
            </section>
            
            <!-- AI 文案优化测试 -->
            <section class="section">
                <h2>AI 文案优化测试</h2>
                <p class="section-description">在这里测试 AI 优化功能，验证文案质量提升效果</p>
                
                <div class="test-container">
                    <div class="input-section">
                        <h3>📝 输入原始文案</h3>
                        <div class="form-group">
                            <label for="testInputText">原始文案</label>
                            <textarea 
                                id="testInputText" 
                                placeholder="请输入需要优化的文案内容，建议包含语法错误、表达不清或需要改进的地方..."
                                rows="6"
                            ></textarea>
                            <small>支持中文文案，建议输入 50-500 字符的文本以获得最佳测试效果</small>
                        </div>
                        
                        <div class="test-options">
                            <div class="option-group">
                                <label>测试场景:</label>
                                <select id="testSiteType">
                                    <option value="console">产品内文案</option>
                                    <option value="marketing">营销/官网</option>
                                    <option value="notification">通知/弹窗</option>
                                </select>
                            </div>
                            
                            <div class="option-group">
                                <label>优化类型:</label>
                                <select id="testOptimizationType">
                                    <option value="optimize">文案优化</option>
                                    <option value="proofread">语法校对</option>
                                </select>
                            </div>
                            
                            <div class="option-group">
                                <label>
                                    <input type="checkbox" id="testStrictMode" checked />
                                    严格边界
                                </label>
                            </div>
                        </div>
                        
                        <div class="test-actions">
                            <button type="button" id="startTest" class="btn btn-primary">
                                🚀 开始 AI 优化测试
                            </button>
                            <button type="button" id="clearTest" class="btn btn-secondary">
                                🗑️ 清空内容
                            </button>
                            <button type="button" id="loadSampleText" class="btn btn-secondary">
                                📋 加载示例文案
                            </button>
                        </div>
                    </div>
                    
                    <div class="result-section" style="display: none;">
                        <h3>✨ AI 优化结果</h3>
                        <div class="result-content">
                            <div class="result-item">
                                <div class="result-header">
                                    <span class="result-label">原始文案</span>
                                    <span class="result-length" id="originalLength">0 字符</span>
                                </div>
                                <div class="result-text original-text" id="originalText"></div>
                            </div>
                            
                            <div class="result-item">
                                <div class="result-header">
                                    <span class="result-label">AI 优化后</span>
                                    <span class="result-length" id="optimizedLength">0 字符</span>
                                </div>
                                <div class="result-text optimized-text" id="optimizedText"></div>
                            </div>
                            
                            <div class="result-item">
                                <div class="result-header">
                                    <span class="result-label">优化详情</span>
                                    <span class="result-status" id="optimizationStatus">处理中...</span>
                                </div>
                                <div class="optimization-details" id="optimizationDetails">
                                    <div class="detail-grid">
                                        <div class="detail-card">
                                            <div class="detail-icon">📊</div>
                                            <div class="detail-content">
                                                <h4>文本长度</h4>
                                                <p id="lengthComparison">-</p>
                                            </div>
                                        </div>
                                        <div class="detail-card">
                                            <div class="detail-icon">🔍</div>
                                            <div class="detail-content">
                                                <h4>语法改进</h4>
                                                <p id="grammarImprovements">-</p>
                                            </div>
                                        </div>
                                        <div class="detail-card">
                                            <div class="detail-icon">💡</div>
                                            <div class="detail-content">
                                                <h4>表达优化</h4>
                                                <p id="expressionImprovements">-</p>
                                            </div>
                                        </div>
                                        <div class="detail-card">
                                            <div class="detail-icon">⏱️</div>
                                            <div class="detail-content">
                                                <h4>处理时间</h4>
                                                <p id="processingTime">-</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="result-actions">
                            <button type="button" id="copyOptimized" class="btn btn-primary" disabled>
                                📋 复制优化结果
                            </button>
                            <button type="button" id="newTest" class="btn btn-secondary">
                                🆕 新测试
                            </button>
                            <button type="button" id="exportResult" class="btn btn-secondary" disabled>
                                💾 导出结果
                            </button>
                        </div>
                    </div>
                    
                    <div class="test-status" id="testStatus" style="display: none;">
                        <div class="status-content">
                            <div class="loading-spinner"></div>
                            <div class="status-text">
                                <h4>AI 正在优化您的文案...</h4>
                                <p id="statusMessage">请稍候，这可能需要几秒钟时间</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>&copy; 2024 LongPort AI 助手 v1.3.1</p>
        </footer>
    </div>

    <script src="options.js"></script>
</body>
</html>
