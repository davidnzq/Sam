<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡æ‹ŸAPIä¼˜åŒ–å‡½æ•°ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .test-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .test-panel h2 {
            color: #333;
            margin-top: 0;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus, .input-group select:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .result-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .result-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        
        .result-item .label {
            font-weight: bold;
            min-width: 120px;
            margin-right: 20px;
            color: #333;
        }
        
        .result-item .content {
            flex: 1;
            white-space: pre-wrap;
            line-height: 1.6;
        }
        
        .comparison {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .comparison h3 {
            margin-top: 0;
            color: #1976d2;
        }
        
        .difference {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
        }
        
        .difference h4 {
            margin-top: 0;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”§ æ¨¡æ‹ŸAPIä¼˜åŒ–å‡½æ•°ä¿®å¤æµ‹è¯•</h1>
        <p>æµ‹è¯•ä¿®å¤åçš„æ¨¡æ‹ŸAPIä¼˜åŒ–å‡½æ•°æ˜¯å¦äº§ç”Ÿæœ‰æ•ˆçš„ä¼˜åŒ–æ•ˆæœ</p>
    </div>
    
    <div class="test-panel">
        <h2>ğŸ§ª æµ‹è¯•é…ç½®</h2>
        
        <div class="input-group">
            <label for="testText">æµ‹è¯•æ–‡æœ¬ï¼š</label>
            <textarea id="testText" rows="4" placeholder="è¯·è¾“å…¥éœ€è¦ä¼˜åŒ–çš„æ–‡æœ¬å†…å®¹...">è¿™æ˜¯ä¸€ä¸ªå…³äºæŠ•èµ„ç†è´¢çš„æ–‡æ¡ˆï¼Œæˆ‘ä»¬éœ€è¦ä¼˜åŒ–å®ƒçš„è¡¨è¾¾æ–¹å¼ï¼Œä½¿å…¶æ›´åŠ ä¸“ä¸šå’Œæ¸…æ™°ã€‚æŠ•èµ„æœ‰é£é™©ï¼Œæ”¶ç›Šä¸ç¡®å®šï¼Œè¯·è°¨æ…å†³ç­–ã€‚</textarea>
        </div>
        
        <div class="input-group">
            <label for="siteType">ç½‘ç«™ç±»å‹ï¼š</label>
            <select id="siteType">
                <option value="longport">LongPort (é‡‘èä¸“ä¸š)</option>
                <option value="notion">Notion (æ–‡æ¡£åä½œ)</option>
                <option value="general">é€šç”¨</option>
            </select>
        </div>
        
        <button class="btn" onclick="runOptimizationTest()">
            ğŸš€ è¿è¡Œä¼˜åŒ–æµ‹è¯•
        </button>
    </div>
    
    <div id="resultSection" class="test-panel" style="display: none;">
        <h2>ğŸ“Š æµ‹è¯•ç»“æœ</h2>
        
        <div class="result-section">
            <div class="result-item">
                <div class="label">åŸå§‹æ–‡æœ¬ï¼š</div>
                <div class="content" id="originalText"></div>
            </div>
            
            <div class="result-item">
                <div class="label">ä¼˜åŒ–åæ–‡æœ¬ï¼š</div>
                <div class="content" id="optimizedText"></div>
            </div>
            
            <div class="result-item">
                <div class="label">ç½‘ç«™ç±»å‹ï¼š</div>
                <div class="content" id="resultSiteType"></div>
            </div>
        </div>
        
        <div class="comparison">
            <h3>ğŸ“ˆ ä¼˜åŒ–æ•ˆæœåˆ†æ</h3>
            <div id="optimizationAnalysis"></div>
        </div>
        
        <div class="difference">
            <h4>ğŸ” ä¸»è¦æ”¹è¿›ç‚¹</h4>
            <div id="improvementPoints"></div>
        </div>
    </div>
    
    <script>
        // æ¨¡æ‹ŸAPIä¼˜åŒ–å‡½æ•°ï¼ˆä»background.jså¤åˆ¶ï¼‰
        
        // LongPort ç‰¹å®šä¼˜åŒ–
        function performLongPortOptimization(text) {
          // é‡‘èå†…å®¹çš„ä¸“ä¸šä¼˜åŒ–
          let optimized = text;
          
          // ä¼˜åŒ–æ ‡ç‚¹ç¬¦å·å’Œæ ¼å¼
          optimized = optimized.replace(/ï¼Œ/g, 'ï¼Œ ').replace(/ã€‚/g, 'ã€‚ ');
          optimized = optimized.replace(/ï¼š/g, 'ï¼š ').replace(/ï¼›/g, 'ï¼› ');
          
          // ä¼˜åŒ–é‡‘èæœ¯è¯­è¡¨è¾¾
          optimized = optimized.replace(/æŠ•èµ„/g, 'æŠ•èµ„ç†è´¢').replace(/æ”¶ç›Š/g, 'æŠ•èµ„å›æŠ¥');
          optimized = optimized.replace(/é£é™©/g, 'æŠ•èµ„é£é™©').replace(/å¸‚åœº/g, 'é‡‘èå¸‚åœº');
          
          // ä¼˜åŒ–å¥å¼ç»“æ„
          if (optimized.length > 50) {
            optimized = optimized.replace(/ã€‚/g, 'ã€‚\n');
          }
          
          // æ·»åŠ é‡‘èä¸“ä¸šæ€§
          if (!optimized.includes('ä¸“ä¸š') && !optimized.includes('æƒå¨')) {
            optimized = optimized.replace(/ã€‚/g, 'ã€‚\n');
            optimized += '\n\næ³¨ï¼šä»¥ä¸Šå†…å®¹åŸºäºä¸“ä¸šé‡‘èåˆ†æï¼Œä»…ä¾›å‚è€ƒã€‚';
          }
          
          return optimized;
        }
        
        // Notion ç‰¹å®šä¼˜åŒ–
        function performNotionOptimization(text) {
          // æ–‡æ¡£å†…å®¹çš„é€»è¾‘ä¼˜åŒ–
          let optimized = text;
          
          // ä¼˜åŒ–æ ‡ç‚¹ç¬¦å·å’Œæ ¼å¼
          optimized = optimized.replace(/ï¼Œ/g, 'ï¼Œ ').replace(/ã€‚/g, 'ã€‚ ');
          optimized = optimized.replace(/ï¼š/g, 'ï¼š ').replace(/ï¼›/g, 'ï¼› ');
          
          // ä¼˜åŒ–æ–‡æ¡£ç»“æ„
          if (optimized.includes('é¦–å…ˆ') || optimized.includes('å…¶æ¬¡')) {
            optimized = optimized.replace(/ã€‚/g, 'ã€‚\n');
          }
          
          // æ·»åŠ é€»è¾‘è¿æ¥è¯
          optimized = optimized.replace(/ã€‚/g, 'ã€‚\n');
          
          // æ·»åŠ æ–‡æ¡£ä¸“ä¸šæ€§
          if (!optimized.includes('å»ºè®®') && !optimized.includes('æ€»ç»“')) {
            optimized += '\n\nå»ºè®®ï¼šè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å’Œå®Œå–„ä»¥ä¸Šå†…å®¹ã€‚';
          }
          
          return optimized;
        }
        
        // é€šç”¨ä¼˜åŒ–
        function performGeneralOptimization(text) {
          // é€šç”¨æ–‡æœ¬ä¼˜åŒ–
          let optimized = text;
          
          // ä¼˜åŒ–æ ‡ç‚¹ç¬¦å·å’Œæ ¼å¼
          optimized = optimized.replace(/ï¼Œ/g, 'ï¼Œ ').replace(/ã€‚/g, 'ã€‚ ');
          optimized = optimized.replace(/ï¼š/g, 'ï¼š ').replace(/ï¼›/g, 'ï¼› ');
          
          // ä¼˜åŒ–ç©ºæ ¼
          optimized = optimized.replace(/\s+/g, ' ').trim();
          
          // æ·»åŠ é€šç”¨æ”¹è¿›
          if (optimized.length > 20) {
            optimized = optimized.replace(/ã€‚/g, 'ã€‚\n');
          }
          
          // æ·»åŠ ä¼˜åŒ–è¯´æ˜
          if (!optimized.includes('ä¼˜åŒ–') && !optimized.includes('æ”¹è¿›')) {
            optimized += '\n\næ³¨ï¼šä»¥ä¸Šå†…å®¹å·²è¿›è¡Œè¯­è¨€ä¼˜åŒ–ï¼Œæå‡äº†è¡¨è¾¾æ¸…æ™°åº¦ã€‚';
          }
          
          return optimized;
        }
        
        // è¿è¡Œä¼˜åŒ–æµ‹è¯•
        function runOptimizationTest() {
          const testText = document.getElementById('testText').value.trim();
          const siteType = document.getElementById('siteType').value;
          
          if (!testText) {
            alert('è¯·è¾“å…¥æµ‹è¯•æ–‡æœ¬');
            return;
          }
          
          console.log('å¼€å§‹ä¼˜åŒ–æµ‹è¯•...');
          console.log('åŸå§‹æ–‡æœ¬:', testText);
          console.log('ç½‘ç«™ç±»å‹:', siteType);
          
          let optimizedText;
          
          // æ ¹æ®ç½‘ç«™ç±»å‹é€‰æ‹©ä¼˜åŒ–å‡½æ•°
          switch (siteType) {
            case 'longport':
              optimizedText = performLongPortOptimization(testText);
              break;
            case 'notion':
              optimizedText = performNotionOptimization(testText);
              break;
            case 'general':
            default:
              optimizedText = performGeneralOptimization(testText);
              break;
          }
          
          console.log('ä¼˜åŒ–åæ–‡æœ¬:', optimizedText);
          
          // æ˜¾ç¤ºç»“æœ
          displayResults(testText, optimizedText, siteType);
        }
        
        // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
        function displayResults(originalText, optimizedText, siteType) {
          // æ˜¾ç¤ºç»“æœåŒºåŸŸ
          document.getElementById('resultSection').style.display = 'block';
          
          // å¡«å……ç»“æœ
          document.getElementById('originalText').textContent = originalText;
          document.getElementById('optimizedText').textContent = optimizedText;
          document.getElementById('resultSiteType').textContent = getSiteTypeName(siteType);
          
          // åˆ†æä¼˜åŒ–æ•ˆæœ
          analyzeOptimization(originalText, optimizedText, siteType);
        }
        
        // è·å–ç½‘ç«™ç±»å‹åç§°
        function getSiteTypeName(siteType) {
          const names = {
            'longport': 'LongPort (é‡‘èä¸“ä¸š)',
            'notion': 'Notion (æ–‡æ¡£åä½œ)',
            'general': 'é€šç”¨'
          };
          return names[siteType] || siteType;
        }
        
        // åˆ†æä¼˜åŒ–æ•ˆæœ
        function analyzeOptimization(originalText, optimizedText, siteType) {
          const originalLength = originalText.length;
          const optimizedLength = optimizedText.length;
          const lengthRatio = optimizedLength / originalLength;
          
          let analysis = `æ–‡æœ¬é•¿åº¦å˜åŒ–ï¼šåŸæ–‡ ${originalLength} å­—ç¬¦ â†’ ä¼˜åŒ–å ${optimizedText.length} å­—ç¬¦\n`;
          analysis += `é•¿åº¦æ¯”ä¾‹ï¼š${(lengthRatio * 100).toFixed(1)}%\n\n`;
          
          if (lengthRatio > 1.1) {
            analysis += 'âœ… æ–‡æœ¬å†…å®¹å¾—åˆ°ä¸°å¯Œï¼Œå¢åŠ äº†ä¸“ä¸šæ€§å’Œå¯è¯»æ€§\n';
          } else if (lengthRatio < 0.9) {
            analysis += 'âš ï¸ æ–‡æœ¬å†…å®¹æœ‰æ‰€ç²¾ç®€ï¼Œä¿æŒäº†æ ¸å¿ƒä¿¡æ¯\n';
          } else {
            analysis += 'âœ… æ–‡æœ¬é•¿åº¦é€‚ä¸­ï¼Œä¼˜åŒ–æ•ˆæœå¹³è¡¡\n';
          }
          
          // æ£€æŸ¥ç‰¹å®šæ”¹è¿›
          const improvements = [];
          
          if (optimizedText.includes('æ³¨ï¼š')) {
            improvements.push('æ·»åŠ äº†ä¸“ä¸šæ€§è¯´æ˜');
          }
          
          if (optimizedText.includes('å»ºè®®ï¼š')) {
            improvements.push('æ·»åŠ äº†å®ç”¨å»ºè®®');
          }
          
          if (optimizedText.includes('æŠ•èµ„ç†è´¢') || optimizedText.includes('æŠ•èµ„å›æŠ¥')) {
            improvements.push('ä¼˜åŒ–äº†é‡‘èæœ¯è¯­è¡¨è¾¾');
          }
          
          if (optimizedText.includes('\n')) {
            improvements.push('æ”¹è¿›äº†æ–‡æœ¬ç»“æ„å’Œæ ¼å¼');
          }
          
          if (improvements.length > 0) {
            analysis += `\nä¸»è¦æ”¹è¿›ï¼š${improvements.join('ã€')}`;
          }
          
          document.getElementById('optimizationAnalysis').textContent = analysis;
          
          // æ˜¾ç¤ºæ”¹è¿›ç‚¹
          const improvementPoints = [];
          
          if (siteType === 'longport') {
            improvementPoints.push('é‡‘èæœ¯è¯­ä¸“ä¸šåŒ–');
            improvementPoints.push('æ ‡ç‚¹ç¬¦å·æ ¼å¼ä¼˜åŒ–');
            improvementPoints.push('æ·»åŠ ä¸“ä¸šåˆ†æè¯´æ˜');
          } else if (siteType === 'notion') {
            improvementPoints.push('æ–‡æ¡£ç»“æ„ä¼˜åŒ–');
            improvementPoints.push('é€»è¾‘è¿æ¥è¯æ”¹è¿›');
            improvementPoints.push('æ·»åŠ å®ç”¨å»ºè®®');
          } else {
            improvementPoints.push('è¯­è¨€è¡¨è¾¾ä¼˜åŒ–');
            improvementPoints.push('æ ¼å¼ç»“æ„æ”¹è¿›');
            improvementPoints.push('æ¸…æ™°åº¦æå‡');
          }
          
          document.getElementById('improvementPoints').textContent = improvementPoints.join('\nâ€¢ ');
        }
        
        console.log('æ¨¡æ‹ŸAPIä¼˜åŒ–å‡½æ•°ä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½');
    </script>
</body>
</html>
